# Blueprint for nested associations
Modifying sails so that i could support nested associations of model in blueprint.

## The proble
as described in this e-mail to the google group

```
Hello,
I recently started using sails and I have a question regarding, Sails nested model associations and blueprint.

If i have a situation such as
User->BlogPost->comments where
- a User has many BlogPost
- a BlogPost has many Comments

And I want to set the model associations so that is a valid ORM association and the blueprint API can generate the corresponding API.

If I do

user/:userId

I see the array of associated blogPosts

If I do
user/:userId/post/:postId

I don't see the comments associated with that post

And the following does not seem to be a valid route generated by the blueprint either

user/:userId/post/:postId/comment

But if I do

post/:postId/comment

I see the array of comments associated with that BlogPost

Am I right in thinking that in order for the comments to show up at the routes through the use of blueprints I need to add something in the user model that sets a relationship between user and comment through BlogPost ?

user/:userId/post/:postId/comment

I am thinking like a has many through in rails.
But that doesn't require a join table just the "traversing" of an intermediate model.

I was wondering if anyone else has come across this issue and what (if any) possible solutions are there to keep this as simple as possible?

Best

Pietro

```

## possible solutions
modifying sails core blueprint hooks

## Hooks
Sails hooks autoEditSailsAPI/node_modules/sails/lib/hooks/blueprints/

## sails core blueprint hooks
in index.js dove fa il model association

line 359
```
// Bind "rest" blueprint/shadow routes based on known associations in our model's schema
// Bind add/remove for each `collection` associations
```

at the moment it looks at alias in model and builds association that way.
which is why is not considering nested once. ie if a user has a blog at this level does not see if a user has posts  through a blog.

User-> Blog -> posts

possible solution, is to us the alias to get its associated model (the nested once) and create the nested route.

this could then be looped until run out of associated models with aliases.
